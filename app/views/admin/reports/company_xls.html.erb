<br/><br/>
<% @companies.each do |company|%>
<% @company = Company.where('id = ?', company).first%>
<table>
	<thead>
		<tr>
			<th>Supplier <%= @company.title%>: Total Reviews</th>
		</tr>

	</thead>

	<tbody>
		<tr>
			<td>Compliments</td>
			<td><%= @compliments = Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and review_type = ?',1.year.ago, Date.today,@company.id, 'compliment').count%></td>
		</tr>
		<tr>
			<td>Complaints</td>
			<td><%= @complaints = Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and review_type = ?',1.year.ago, Date.today,@company.id, 'complaint').count%></td>
		</tr>
		<tr>
			<td><strong>Total</strong></td>
			<td><%= @complaints + @compliments%></td>
		</tr>

	</tbody>
</table>

<br/><br/>
<table>
	<thead>
		<tr>
			<th>Supplier <%= @company.title%> :Nature of Compliments</th>
		</tr>

	</thead>

	<tbody>
		<tr>
			<td>Billing/accounts</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today, @company.id ,'Billing/accounts', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Booking</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id , 'Booking', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Call centre efficiency</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Call centre efficiency', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Contract</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Contract', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Delivery on time</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Delivery on time', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Feedback</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Feedback', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Going the extra mile</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Going the extra mile', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Great attitude</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Great attitude', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Pricing</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Pricing', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Refund</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Refund', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Repairs</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Repairs', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Stock</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Stock', 'compliment').count%></td>
		</tr>
		<tr>
			<td>Other</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Other', 'compliment').count%></td>
		</tr>

	</tbody>
</table>
<br/><br/>


<table>
	<thead>
		<tr>
			<th>Supplier <%= @company.title%> :Nature of Complaints</th>
		</tr>

	</thead>

	<tbody>
		<tr>
			<td>Billing/accounts</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today, @company.id ,'Billing/accounts', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Booking</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id , 'Booking', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Call centre efficiency</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Call centre efficiency', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Contract</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Contract', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Delivery on time</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Delivery on time', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Feedback</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Feedback', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Going the extra mile</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Going the extra mile', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Great attitude</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Great attitude', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Pricing</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Pricing', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Refund</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Refund', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Repairs</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Repairs', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Stock</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Stock', 'complaint').count%></td>
		</tr>
		<tr>
			<td>Other</td>
			<td><%= Review.where('created_at >= ? and created_at <= ? and user_id is not null and industry_id = ? and nature_of_review = ? and review_type = ?',1.year.ago, Date.today,@company.id,'Other', 'complaint').count%></td>
		</tr>

	</tbody>
</table>
<%end%>